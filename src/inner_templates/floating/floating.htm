<!doctype html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- Include the CesiumJS JavaScript and CSS files -->
  <script src="jquery-3.6.0.min.js"></script>
  <script src="globals.js"></script>
  <script src="main_ws_manager.js"></script>
  <style>
  td {
    text-align: center;
    vertical-align: middle;
  }
  canvas{
      -moz-user-select: none;
      -webkit-user-select: none;
      -ms-user-select: none;
  }
  </style>
</head>
  <body style="background-color: #000000">
         <table class="metrics" style="background-color: #000000; color: #FFFFFF; font-family: sans-serif border: 0">
         <tr class="speed"><td>🏃</td><td><small>km/h</small></td><td class="speed-value"><b>25.0</b></td><td><small>AVG</small></td><td class="speed-avg">22.2</td></tr>
         <tr class="cadence"><td>🚴</td><td><small>rpm</small></td><td class="cadence-value"><b>62</b></td><td class="cadence-avg"><small>AVG</small></td><td>67</td></tr>
         <tr class="heart"><td>💓</td><td><small>bpm</small></td><td class="heart-value"><b>110</b></td><td class="heart-avg"><small>AVG</small></td><td>130</td></tr>
         <tr class="watt"><td>⚡</td><td><small>watt</small></td><td class="watt-value"><b>110</b></td><td class="watt-avg"><small>AVG</small></td><td>160</td></tr>
         <tr class="resistance"><td>🧲</td><td><small>level</small></td><td class="resistance-value"><b>11</b></td><td class="resistance-avg"><small>AVG</small></td><td>13</td></tr>
         <tr class="pelotonresistance"><td>🅿</td><td><small>level</small></td><td class="pelotonresistance-value"><b>56</b></td><td class="pelotonresistance-avg"><small>AVG</small></td><td>71</td></tr>
         <tr class="calories"><td>🔥</td><td><small>kcal</small></td><td class="calories-value" colspan="3"><b>1100</b></td></tr>
         <tr class="distance"><td>📏</td><td><small>km</small></td><td class="distance-value" colspan="3"><b>11.0</b></td></td></tr>
         <tr class="elapsed"><td>⏲️</td><td><small>time</small></td><td class="elapsed-value" colspan="3"><b>0:00:00</b></td></tr>
         </table>
    <script type="text/javascript">
    function a() {
    onWorkout = false;
    keys_arr = ['speed', 'speed_avg','cadence','cadence_avg', 'heart','heart_avg', 'calories', 'distance', 'watts','watts_avg', 'elapsed_h', 'elapsed_m', 'elapsed_s', 'resistance','resistance_avg', 'peloton_resistance','peloton_resistance_avg']
         let ell = new MainWSQueueElement({
	     msg: null,
		}, function(msg) {
		  if (msg.msg === 'workout') {
                                var speed = 0;
                                var speed_avg = 0;
				var cadence = 0;
                                var cadence_avg = 0;
				var hr = 0;
                                var hr_avg = 0;
				var calories = 0;
				var odometer = 0;
				var watt = 0;
                                var watt_avg = 0;
				var elapsed_h = 0;
				var elapsed_m = 0;
				var elapsed_s = 0;
				var resistance = 0;
                                var resistance_avg = 0;
                                var peloton_resistance = 0;
                                var peloton_resistance_avg = 0;
				for (let key of keys_arr) {
				    if (msg.content[key] === undefined)
                                             continue;
						if (key === 'speed') {
                                                  speed = msg.content[key];
                                                } else if (key === 'speed_avg') {
                                                  speed_avg = msg.content[key];
						} else if (key === 'cadence') {
						  cadence = msg.content[key];
                                                } else if (key === 'cadence_avg') {
                                                  cadence_avg = msg.content[key];
						} else if (key === 'heart') {
                                                  hr = msg.content[key];
                                                } else if (key === 'heart_avg') {
                                                  hr_avg = msg.content[key];
						} else if (key === 'calories') {
                                                  calories = msg.content[key];
						} else if (key === 'distance') {
                                                  odometer = msg.content[key];
						} else if (key === 'watts') {
                                                  watt = msg.content[key];
                                                } else if (key === 'watts_avg') {
                                                  watt_avg = msg.content[key];
						} else if (key === 'elapsed_h') {
                                                  elapsed_h = msg.content[key];
						} else if (key === 'elapsed_m') {
                                                  elapsed_m = msg.content[key];
						} else if (key === 'elapsed_s') {
                                                  elapsed_s = msg.content[key];
						} else if (key === 'resistance') {
                                                  resistance = msg.content[key];
                                                } else if (key === 'resistance_avg') {
                                                  resistance_avg = msg.content[key];
                                                } else if (key === 'peloton_resistance') {
                                                  peloton_resistance = msg.content[key];
                                                } else if (key === 'peloton_resistance_avg') {
                                                  peloton_resistance_avg = msg.content[key];
                                                }
				}
                                $('.speed-value').html("<b>" + speed.toFixed(1) + "</b>");
                                $('.speed-avg').html(speed_avg.toFixed(1));
                                $('.distance-value').html("<b>" + odometer.toFixed(2) + "</b>");
                                //$('.metrics').html("🏃Speed: " + speed.toFixed(2) + "<br>🚴Cadence:" + cadence.toFixed(0) + "<br>💓Heart:"+ hr.toFixed(0) + "<br>🔥Calories:"+ calories.toFixed(1) + "<br>📏Odometer:"+ odometer.toFixed(2) + "<br>⚡Watt:"+ watt.toFixed(0) + "<br>⏲️Elapsed:"+ elapsed_h.toString().padStart(2, "0") + ":" + elapsed_m.toString().padStart(2, "0") + ":"+ elapsed_s.toString().padStart(2, "0") + "<br>📐Inclination:"+ inclination.toFixed(1) + "<br>🧲Resistance:"+ resistance.toFixed(0) + "<br>✈️Altitude:"+ altitude.toFixed(1) + "<br>⛰️Elevation:"+ elevation.toFixed(2));
		  }
		  return null;
		}, 15000, 3);
         ell.enqueue().then(onWorkout).catch(function(err) {
	     console.error('Error is ' + err);
                });
    }
      setTimeout(a,0);
    </script>
  </body>
</html>
