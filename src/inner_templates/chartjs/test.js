window.chartColors = {
    red: 'rgb(255, 99, 132)',
    orange: 'rgb(255, 159, 64)',
    yellow: 'rgb(255, 205, 86)',
    green: 'rgb(75, 192, 192)',
    blue: 'rgb(54, 162, 235)',
    purple: 'rgb(153, 102, 255)',
    grey: 'rgb(201, 203, 207)'
};
let watts = [
    {
        'x': 6,
        'y': 24
    },
    {
        'x': 8,
        'y': 24
    },
    {
        'x': 9,
        'y': 24
    },
    {
        'x': 10,
        'y': 35
    },
    {
        'x': 11,
        'y': 37
    },
    {
        'x': 12,
        'y': 37
    },
    {
        'x': 13,
        'y': 33
    },
    {
        'x': 14,
        'y': 33
    },
    {
        'x': 15,
        'y': 31
    },
    {
        'x': 16,
        'y': 28
    },
    {
        'x': 17,
        'y': 28
    },
    {
        'x': 18,
        'y': 33
    },
    {
        'x': 19,
        'y': 32
    },
    {
        'x': 20,
        'y': 32
    },
    {
        'x': 21,
        'y': 27
    },
    {
        'x': 22,
        'y': 27
    },
    {
        'x': 23,
        'y': 0
    },
    {
        'x': 24,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 26,
        'y': 12
    },
    {
        'x': 27,
        'y': 0
    },
    {
        'x': 28,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    },
    {
        'x': 25,
        'y': 0
    }
];

function process_arr() {
    var config = {
        type: 'line',
        data: {
            datasets: [{
                label: 'Watts',
                backgroundColor: window.chartColors.red,
                borderColor: window.chartColors.red,
                data: watts,
                fill: false,
            }]
        },
        options: {
            responsive: true,
            grid: {
                zeroLineColor: 'rgba(0,255,0,1)'
            },
            plugins: {
                title:{
                    display:true,
                    text:'Chart.js Line Chart'
                },
                tooltips: {
                    mode: 'index',
                    intersect: false,
                }
            },
            hover: {
                mode: 'nearest',
                intersect: true
            },
            scales: {
                x: {
                    type: 'linear',
                    display: true,
                    title: {
                        display: true,
                        text: 'Seconds'
                    }
                },
                y: {
                    display: true,
                    title: {
                        display: true,
                        text: 'Watt'
                    }
                }
            }
        }
    };

    let ctx = document.getElementById('canvas').getContext('2d');
    new Chart(ctx, config);
}

function dochart_init() {
    let el = new MainWSQueueElement({
        msg: 'getsessionarray'
    }, function(msg) {
        if (msg.msg === 'R_getsessionarray') {
            return msg.content;
        }
        return null;
    }, 5000, 3);
    el.enqueue().then(process_arr).catch(function(err) {
        console.error('Error is ' + err);
    });
}


$(window).on('load', function () {
    process_arr();
});